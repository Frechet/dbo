# ДБО (Тестовое задание, база ДБО по работе с балансом клиента)

[Тестовое задание на 6-8 часов](Task.pdf)

## Комментарии решению

### Что удалось

1) Учесть пессимистик Lock при изменении балансов
2) Добавить USER_ID кастомный Claim в JWT
3) Подключить тестконтейнеры и реализовать компонентные и юнит тесты
4) Настроить удобные инструменты: lombok, mapstruct, flyway
5) Настроить Swagger, да ещё с возможностью делать в нём запросы пройдя авторизацию и передавая JWT токен
6) Добавить docker и docker-compose для сборки и запуска всего решения с инфраструктурой одной кнопкой

### Что улучшить не успел

1) C.UD операции и гибкий поиск. Успел реализовать CRUD для Phone только с R для клиента.
2) Кеш в редисе, чтобы показать что могу, так как упоминался в задании. 
Но надо исходить из проблематики сервиса, 
если интересен гибкий оперативный поиск по базе клиента,
то интереснее было бы решения на базе Elastic
3) Уделить достаточно внимания валидациям
4) Улучшить логирование. Добавлял по ходу собственной же отладке.
5) Java доки + более развёрнутое описание API в Swagger

### Чего не было в задании, но важно

1) Хранение паролей в зашифрованном виде
2) Вместо таблицы USER использовал наименование CLIENT, 
чтобы не пересекаться зарезервированным именем в POstgreSQL.

## Собрать

Установите

1) Java 11
2) Maven 3.8
3) Docker

Запустите команду

`mvn clean package`

## Запустить

### Через Docker Compose

Уставите Docker Compose

`docker, docker-buildx, docker-compose`

Запустите приложение с инфраструктурой

`docker-compose up -d`

## Работа с сервисом

Авторизация по почте. [Список пользователей](src/main/resources/db/migration/V2__init_data.sql).

### Swagger

http://localhost:8080/swagger-ui/index.html

### Postman

[Postman коллекция](task_dbo.postman_collection.json)

